<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ประชุมวิชาการปีแผนกอายุรกรรม ประจำ 2568 | โรงพยาบาลบุรีรัมย์</title>
  <meta name="description" content="Harmony of Care: Bridging General Care to Specialty Medicine — ประชุมวิชาการปีแผนกอายุรกรรม ประจำ 2568 แผนกอายุรกรรม โรงพยาบาลบุรีรัมย์ (เข้าร่วมฟรี)" />
  <meta name="theme-color" content="#0b3b6e" />
  <link rel="icon" type="image/x-icon" href="public/favicon.ico" />
  <!-- Open Graph -->
  <meta property="og:title" content="ประชุมวิชาการปีแผนกอายุรกรรม ประจำ 2568 | โรงพยาบาลบุรีรัมย์" />
  <meta property="og:description" content="Harmony of Care: Bridging General Care to Specialty Medicine — เข้าร่วมฟรี 6–7 พฤศจิกายน 2568 ณ หอประชุมโรงพยาบาลบุรีรัมย์" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="Logo Internal Medicine BRH 2025.png" />

  <!-- Fonts: Sarabun -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Sarabun', 'ui-sans-serif', 'system-ui'] },
          colors: {
            brh: {
              50:  '#e8eef7',
              100: '#d3def0',
              200: '#a8bde1',
              300: '#7e9cd3',
              400: '#557cc5',
              500: '#2c5bb7',
              600: '#204693',
              700: '#16336d',
              800: '#0f2550',
              900: '#0b1b3b'
            }
          },
          boxShadow: {
            glow: '0 0 0 6px rgba(255,255,255,0.15)',
          },
          backgroundImage: {
            'mesh': 'radial-gradient(50% 50% at 10% 10%, rgba(59,130,246,.15) 0%, rgba(59,130,246,0) 60%), radial-gradient(50% 50% at 90% 20%, rgba(16,185,129,.15) 0%, rgba(16,185,129,0) 60%), radial-gradient(60% 60% at 30% 80%, rgba(99,102,241,.15) 0%, rgba(99,102,241,0) 60%)'
          }
        }
      }
    }
  </script>
  <style>
    html{scroll-behavior:smooth}
    @media (prefers-reduced-motion: reduce){ html{scroll-behavior:auto} }
  </style>
</head>
<body class="font-sans text-slate-800 bg-slate-50">
  <!-- Top bar -->
  <header class="fixed z-50 w-full backdrop-blur bg-white/80 border-b border-slate-200/60">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <a href="#top" class="flex items-center gap-3 group" aria-label="หน้าแรก">
          <img id="logo-sm" src="public/Logo.png" alt="Internal Medicine Buriram Hospital" class="h-10 w-10 rounded-full ring-2 ring-brh-700/20 group-hover:ring-brh-700/40 transition" />
          <div class="leading-none">
            <div class="text-sm text-slate-700">Internal Medicine</div>
            <div class="text-[10px] text-slate-500 -mt-0.5">Buriram Hospital</div>
          </div>
        </a>
        <nav class="hidden md:flex items-center gap-6 text-sm">
          <a href="#about" class="hover:text-brh-700">เกี่ยวกับงาน</a>
          <a href="#agenda" class="hover:text-brh-700">กำหนดการ</a>
          <a href="#venue" class="hover:text-brh-700">สถานที่</a>
          <a href="#faq" class="hover:text-brh-700">FAQ</a>
        </nav>
        <div class="flex items-center gap-3">
          <a href="#register" class="inline-flex items-center gap-2 rounded-xl bg-brh-700 px-4 py-2 text-white shadow hover:bg-brh-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-brh-500">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14m7-7H5"/></svg>
            ลงทะเบียน
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section id="top" class="relative isolate overflow-hidden pt-28 sm:pt-32 bg-gradient-to-b from-brh-900 via-brh-800 to-brh-700 text-white">
    <div class="absolute inset-0 bg-mesh opacity-60 mix-blend-overlay pointer-events-none"></div>
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-16">
      <div class="grid lg:grid-cols-2 gap-10 items-center">
        <div>
          <span class="inline-flex items-center gap-2 text-xs font-semibold uppercase tracking-widest bg-white/10 border border-white/20 px-3 py-1.5 rounded-full backdrop-blur">
            เข้าร่วมฟรี · 6–7 พฤศจิกายน 2568
          </span>
          <h1 class="mt-4 text-3xl sm:text-4xl lg:text-5xl font-extrabold leading-tight">
            ประชุมวิชาการแผนกอายุรกรรม ประจำปี 2568<br>
            <span class="text-emerald-300">Harmony of Care</span>
          </h1>
          <p class="mt-4 text-white/90 text-base sm:text-lg max-w-xl">
            Bridging General Care to Specialty Medicine — ร่วมแลกเปลี่ยนองค์ความรู้และแนวทางดูแลผู้ป่วยจากเวชปฏิบัติทั่วไปสู่สหสาขาเฉพาะทาง
            สำหรับบุคลากรทางการแพทย์ของ <span class="font-semibold">โรงพยาบาลชุมชนในจังหวัดบุรีรัมย์</span> ทุกท่าน
          </p>
          <ul class="mt-6 grid grid-cols-2 gap-3 text-sm text-white/90 max-w-lg">
            <li class="flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-emerald-300"></span>6–7 พ.ย. 2568</li>
            <li class="flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-emerald-300"></span>ณ ห้องประชุม 901 ชั้น 9 อาคารเฉลิมพระเกียรติฯ โรงพยาบาลบุรีรัมย์</li>
            <li class="flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-emerald-300"></span>เข้าร่วมฟรี ไม่เสียค่าใช้จ่าย</li>
            <li class="flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-emerald-300"></span>กลุ่มเป้าหมาย: โรงพยาบาลชุมชน</li>
          </ul>
          <div class="mt-8 flex flex-wrap items-center gap-4">
            <a href="#register" class="inline-flex items-center gap-2 rounded-2xl bg-white text-brh-800 px-5 py-3 font-semibold shadow hover:shadow-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-white/80">
              ลงทะเบียนเข้าร่วม
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </a>
            <button id="addCalendar" class="inline-flex items-center gap-2 rounded-2xl border border-white/30 bg-white/10 px-5 py-3 font-medium text-white hover:bg-white/20 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/60">
              เพิ่มลงปฏิทิน (.ics)
            </button>
          </div>
          <div class="mt-6 text-sm text-white/70">
            เริ่มงานในอีก <span id="dd" class="font-semibold">--</span> วัน <span id="hh" class="font-semibold">--</span> ชม. <span id="mm" class="font-semibold">--</span> นาที
          </div>
        </div>
        <div class="relative">
          <div class="absolute -inset-6 rounded-3xl bg-white/10 blur-2xl"></div>
          <div class="relative mx-auto max-w-sm rounded-3xl bg-white shadow-2xl shadow-black/20 ring-8 ring-white/10 overflow-hidden">
            <img id="logo-lg" src="public/Logo.png" alt="ตราสัญลักษณ์แผนกอายุรกรรม โรงพยาบาลบุรีรัมย์" class="w-full h-full object-contain bg-white p-6" />
          </div>
        </div>
      </div>
    </div>
    <svg class="absolute bottom-0 left-0 w-full" viewBox="0 0 1440 80" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none"><path fill="#f8fafc" d="M0,64L48,58.7C96,53,192,43,288,48C384,53,480,75,576,69.3C672,64,768,32,864,26.7C960,21,1056,43,1152,53.3C1248,64,1344,64,1392,64L1440,64L1440,80L1392,80C1344,80,1248,80,1152,80C1056,80,960,80,864,80C768,80,672,80,576,80C480,80,384,80,288,80C192,80,96,80,48,80L0,80Z"/></svg>
  </section>

  <!-- About -->
  <section id="about" class="py-8">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-3 gap-10 items-start">
        <div class="lg:col-span-2">
          <h2 class="text-2xl sm:text-3xl font-bold text-brh-800">เกี่ยวกับงาน</h2>
          <p class="mt-4 text-slate-700 text-lg leading-8">
            ประชุมวิชาการ <strong>แผนกอายุรกรรม โรงพยาบาลบุรีรัมย์</strong> ภายใต้แนวคิด
            <span class="font-semibold">“Harmony of Care: Bridging General Care to Specialty Medicine”</span>
            มุ่งสร้างเครือข่ายความร่วมมือระหว่างทีมดูแลผู้ป่วยระดับโรงพยาบาลชุมชนและสาขาเฉพาะทาง
            เพื่อยกระดับคุณภาพการรักษาอย่างต่อเนื่องในจังหวัดบุรีรัมย์
          </p>
          <div class="mt-6 grid sm:grid-cols-3 gap-4">
            <div class="rounded-2xl bg-white p-5 border border-slate-200 shadow-sm">
              <div class="text-sm text-slate-500">วันที่</div>
              <div class="mt-1 font-semibold">6–7 พฤศจิกายน 2568</div>
            </div>
            <div class="rounded-2xl bg-white p-5 border border-slate-200 shadow-sm">
              <div class="text-sm text-slate-500">สถานที่</div>
              <div class="mt-1 font-semibold">ห้องประชุม 901 ชั้น 9 อาคารเฉลิมพระเกียรติฯ โรงพยาบาลบุรีรัมย์</div>
            </div>
            <div class="rounded-2xl bg-white p-5 border border-slate-200 shadow-sm">
              <div class="text-sm text-slate-500">ค่าลงทะเบียน</div>
              <div class="mt-1 font-semibold">เข้าร่วมฟรี</div>
            </div>
          </div>
        </div>
        <aside class="rounded-2xl bg-emerald-50 p-6 border border-emerald-200">
          <h3 class="font-semibold text-emerald-900">กลุ่มเป้าหมาย</h3>
          <p class="mt-2 text-emerald-800 text-sm leading-6">
            บุคลากรทางการแพทย์ของโรงพยาบาลชุมชนในจังหวัดบุรีรัมย์ เช่น แพทย์ พยาบาล เภสัชกร นักกายภาพบำบัด นักเทคนิคการแพทย์ และทีมสหสาขาวิชาชีพที่เกี่ยวข้อง
          </p>
          <a href="#register" class="mt-4 inline-flex items-center justify-center w-full rounded-xl bg-emerald-600 px-4 py-2.5 text-white font-semibold hover:bg-emerald-500">ลงทะเบียน</a>
        </aside>
      </div>
    </div>
  </section>

  <!-- Agenda Preview -->
  <section id="agenda" class="py-8 bg-white">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl sm:text-3xl font-bold text-brh-800">กำหนดการ</h2>
      <div class="mt-8 grid md:grid-cols-2 gap-6">
        <div class="rounded-2xl border border-slate-200 bg-slate-50 p-6">
          <h3 class="font-semibold text-slate-800">วันพฤหัสบดีที่ 6 พ.ย. 2568</h3>
          <ul class="mt-3 space-y-2 text-sm text-slate-700">
            <li>• พิธีเปิด &amp; ปาฐกถาพิเศษ</li>
            <li>• Update in General Internal Medicine</li>
            <li>• Bridging Primary to Specialty: Cardio, Pulmo, Endo</li>
            <li>• Interactive Case-based Discussion</li>
          </ul>
        </div>
        <div class="rounded-2xl border border-slate-200 bg-slate-50 p-6">
          <h3 class="font-semibold text-slate-800">วันศุกร์ที่ 7 พ.ย. 2568</h3>
          <ul class="mt-3 space-y-2 text-sm text-slate-700">
            <li>• Practical Workshops (ECG / ABG / Acute Care)</li>
            <li>• Referral &amp; Co‑management Pathways</li>
            <li>• Quality &amp; Patient Safety in Continuum of Care</li>
            <li>• สรุปและปิดการประชุม</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Registration -->
  <section id="register" class="py-8 bg-gradient-to-br from-slate-100 to-white">
    <div class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8">
      <div class="rounded-3xl border border-slate-200 bg-white p-8 sm:p-10 shadow">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
          <div>
            <h2 class="text-2xl font-bold text-brh-800">ลงทะเบียนเข้าร่วมงาน</h2>
            <p class="mt-1 text-slate-600 text-sm">คลิกปุ่มด้านขวาเพื่อไปยังแบบฟอร์มลงทะเบียน (ฟรี ไม่มีค่าใช้จ่าย)</p>
          </div>
          <a id="registerBtn" href="#" target="_blank" rel="noopener" class="inline-flex items-center gap-2 rounded-2xl bg-brh-700 px-6 py-3 text-white font-semibold hover:bg-brh-600" aria-label="ไปยังหน้าลงทะเบียน">
            ไปยังแบบฟอร์ม
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
          </a>
        </div>

      </div>
    </div>
  </section>

  <!-- Venue -->
  <section id="venue" class="py-8">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-2 gap-8 items-start">
        <div>
          <h2 class="text-2xl sm:text-3xl font-bold text-brh-800">สถานที่จัดงาน</h2>
          <p class="mt-3 text-slate-700">ณ ห้องประชุม 901 ชั้น 9 อาคารเฉลิมพระเกียรติฯ โรงพยาบาลบุรีรัมย์ จังหวัดบุรีรัมย์</p>
          <ul class="mt-4 space-y-2 text-sm text-slate-600">
            <li>• มีที่จอดรถภายในโรงพยาบาล</li>
            <li>• กรุณามาถึงก่อนเวลาเพื่อความสะดวกในการลงทะเบียน</li>
          </ul>
        </div>
        <div class="rounded-2xl overflow-hidden border border-slate-200 shadow-sm bg-white">
          <iframe title="แผนที่โรงพยาบาลบุรีรัมย์" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d963.4431954943658!2d103.10123689762192!3d15.005313175023634!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x311995c24c571e9b%3A0xbd001d168b47f75b!2z4Lit4Liy4LiE4Liy4Lij4LmA4LiJ4Lil4Li04Lih4Lie4Lij4Liw4LmA4LiB4Li14Lii4Lij4LiV4Li04LCBIuC5g-C4meC5guC4reC4geC4suC4quC4nuC4o-C4sOC4iuC4meC4oeC4suC4ouC4uOC4hOC4o-C4miDguZUg4Lij4Lit4LiaIOC5kiDguYDguKHguKnguLLguKLguJkg4LmS4LmV4LmV4LmY!5e0!3m2!1sth!2sth!4v1757622386546!5m2!1sth!2sth" class="w-full h-[360px] md:h-[420px]" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section id="faq" class="py-8 bg-slate-50">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl sm:text-3xl font-bold text-brh-800">คำถามที่พบบ่อย</h2>
      <div class="mt-6 grid md:grid-cols-2 gap-6">
        <details class="rounded-2xl bg-white p-6 border border-slate-200" open>
          <summary class="font-semibold text-slate-800 cursor-pointer">ต้องเสียค่าใช้จ่ายหรือไม่?</summary>
          <p class="mt-2 text-slate-700">ไม่ต้องเสียค่าใช้จ่าย <strong>เข้าร่วมฟรี</strong> สำหรับบุคลากรทางการแพทย์ในจังหวัดบุรีรัมย์</p>
        </details>
        <details class="rounded-2xl bg-white p-6 border border-slate-200">
          <summary class="font-semibold text-slate-800 cursor-pointer">กลุ่มเป้าหมายคือใคร?</summary>
          <p class="mt-2 text-slate-700">บุคลากรทางการแพทย์ของโรงพยาบาลชุมชนทุกอำเภอในจังหวัดบุรีรัมย์</p>
        </details>
        <details class="rounded-2xl bg-white p-6 border border-slate-200">
          <summary class="font-semibold text-slate-800 cursor-pointer">จะประกาศกำหนดการฉบับเต็มเมื่อไร?</summary>
          <p class="mt-2 text-slate-700">รายละเอียดวิทยากรและหัวข้อจะเผยแพร่ในหน้านี้เมื่อพร้อม โปรดติดตาม</p>
        </details>
        <details class="rounded-2xl bg-white p-6 border border-slate-200">
          <summary class="font-semibold text-slate-800 cursor-pointer">แต่งกายอย่างไร?</summary>
          <p class="mt-2 text-slate-700">ชุดสุภาพหรือเครื่องแบบปฏิบัติงาน เหมาะสมกับสถานพยาบาล</p>
        </details>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="py-8 bg-brh-900 text-white">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="flex flex-col md:flex-row items-center justify-between gap-4">
        <div class="flex flex-col md:flex-row items-center gap-4">
          <p class="text-white/80 text-sm">© <span id="year"></span> Internal Medicine · Buriram Hospital</p>
          <a href="https://www.facebook.com/profile.php?id=61580099820023" target="_blank" rel="noopener" class="inline-flex items-center gap-2 text-white/80 hover:text-white text-sm transition-colors">
            <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
            Facebook
          </a>
        </div>
        <div class="text-xs text-white/60">Harmony of Care: Bridging General Care to Specialty Medicine</div>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script>
    // === CONFIG ===
    // 1) Replace with your live registration link (e.g., Google Form / DocSync form)
    const REGISTER_URL = 'https://forms.gle/BpFTkuUwUWSLRQSu9'; // e.g. 'https://forms.gle/xxxxxxxx'
    // 2) Event start/end in ISO 8601 (Bangkok time +07:00)
    const EVENT_START_ISO = '2025-11-06T08:30:00+07:00';
    const EVENT_END_ISO   = '2025-11-07T16:30:00+07:00';
    // 3) Logo filename (place your provided PNG next to this HTML)
    const LOGO_SRC = 'public/Logo.png';

    // Apply config
    document.getElementById('registerBtn').href = REGISTER_URL;
    document.getElementById('logo-sm').src = LOGO_SRC;
    document.getElementById('logo-lg').src = LOGO_SRC;
    document.getElementById('year').textContent = new Date().getFullYear();

    // Agenda: load from public/agenda.json and render
    (async () => {
      const agendaSection = document.getElementById('agenda');
      if (!agendaSection) return;
      const staticGrid = agendaSection.querySelector('.grid.md\\:grid-cols-2');
      const root = document.createElement('div');
      root.id = 'agenda-root';
      root.className = 'mt-8 grid md:grid-cols-2 gap-6';
      if (staticGrid && staticGrid.parentNode) {
        staticGrid.parentNode.insertBefore(root, staticGrid);
      } else {
        agendaSection.appendChild(root);
      }
      const setStatus = (html, cls='text-slate-500') => {
        root.innerHTML = `<div class="col-span-2 text-center ${cls}">${html}</div>`;
      };
      setStatus('Loading agenda…');
      try {
        const res = await fetch('public/agenda.json', { cache: 'no-store' });
        if (!res.ok) throw new Error('HTTP ' + res.status);
        const text = await res.text();
        let data;
        try { data = JSON.parse(text); }
        catch (e) { throw new Error('Invalid JSON in agenda.json'); }
        renderAgenda(data, root);
        if (staticGrid) staticGrid.style.display = 'none';
      } catch (err) {
        console.error('Agenda load error:', err);
        setStatus('Failed to load agenda', 'text-red-600');
      }

      function escapeHTML(s) {
        return String(s ?? '').replace(/[&<>\"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));
      }
      function renderAgenda(data, container) {
        container.innerHTML = '';
        if (Array.isArray(data)) {
          container.appendChild(renderDayColumns('Agenda', data));
          return;
        }
        if (data && typeof data === 'object') {
          for (const key of Object.keys(data)) {
            const items = Array.isArray(data[key]) ? data[key] : [];
            container.appendChild(renderDayColumns(key, items));
          }
          return;
        }
        setStatus('No agenda data', 'text-slate-500');
      }
      function renderDay(title, items) {
        const card = document.createElement('div');
        card.className = 'rounded-2xl border border-slate-200 bg-slate-50 p-6';
        const h3 = document.createElement('h3');
        h3.className = 'font-semibold text-slate-800';
        h3.textContent = title;
        card.appendChild(h3);
        const ul = document.createElement('ul');
        ul.className = 'mt-3 space-y-2 text-sm text-slate-700';
        for (const it of items) {
          const li = document.createElement('li');
          const time = escapeHTML(it.time || '');
          const topic = escapeHTML(it.topic || '');
          const speaker = escapeHTML(it.speaker || '');
          li.innerHTML = `<span class="font-semibold text-slate-800">${time}</span> — ${topic}` + (speaker && speaker !== '-' ? `<div class="text-slate-500 text-xs mt-0.5">${speaker}</div>` : '');
          ul.appendChild(li);
        }
        card.appendChild(ul);
        return card;
      }

      // New renderer with separate time/topic columns
      function renderDayColumns(title, items) {
        const card = document.createElement('div');
        card.className = 'rounded-2xl border border-slate-200 bg-slate-50 p-6';
        const h3 = document.createElement('h3');
        h3.className = 'font-semibold text-slate-800';
        h3.textContent = title;
        card.appendChild(h3);
        const ul = document.createElement('ul');
        ul.className = 'mt-4 text-sm text-slate-700 divide-y divide-slate-200 border-t border-slate-200';
        for (const it of items) {
          const time = escapeHTML(it.time || '');
          const topic = escapeHTML(it.topic || '');
          const speaker = escapeHTML(it.speaker || '');
          const li = document.createElement('li');
          li.className = 'flex gap-4 py-3 items-start';
          li.innerHTML = `
            <span class="w-24 sm:w-28 shrink-0 font-semibold text-slate-800 leading-6">${time}</span>
            <div class="min-w-0 flex-1 leading-6">
              <div class="text-slate-800">${topic}</div>
              ${speaker && speaker !== '-' ? `<div class="text-slate-500 text-xs mt-0.5">${speaker}</div>` : ''}
            </div>`;
          ul.appendChild(li);
        }
        card.appendChild(ul);
        return card;
      }
    })();

    // Smooth-scroll for in-page anchors (enhanced for older browsers)
    document.querySelectorAll('a[href^="#"]').forEach(a => {
      a.addEventListener('click', (e) => {
        const id = a.getAttribute('href');
        if (id.length > 1) {
          const el = document.querySelector(id);
          if (el) {
            e.preventDefault();
            el.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        }
      });
    });

    // Countdown to event start
    const startDate = new Date(EVENT_START_ISO);
    const dd = document.getElementById('dd');
    const hh = document.getElementById('hh');
    const mm = document.getElementById('mm');
    const tick = () => {
      const now = new Date();
      const ms = startDate - now;
      if (ms <= 0) {
        dd.textContent = '0'; hh.textContent = '0'; mm.textContent = '0';
        clearInterval(intv);
        return;
      }
      const totalMinutes = Math.floor(ms / 60000);
      const days = Math.floor(totalMinutes / (60*24));
      const hours = Math.floor((totalMinutes % (60*24)) / 60);
      const minutes = totalMinutes % 60;
      dd.textContent = days; hh.textContent = hours; mm.textContent = minutes;
    };
    const intv = setInterval(tick, 30_000); // update every 30s
    tick();

    // Add to Calendar (.ics)
    document.getElementById('addCalendar').addEventListener('click', () => {
      const dtStamp = new Date().toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
      const toICSDate = (iso) => iso.replace(/[-:]/g, '').replace('.000','');
      const ics = [
        'BEGIN:VCALENDAR',
        'VERSION:2.0',
        'PRODID:-//BRH IM Conference//TH',
        'CALSCALE:GREGORIAN',
        'METHOD:PUBLISH',
        'BEGIN:VEVENT',
        `DTSTAMP:${dtStamp}`,
        `DTSTART:${toICSDate(EVENT_START_ISO)}`,
        `DTEND:${toICSDate(EVENT_END_ISO)}`,
        'UID:imconf-2568@buriram-hospital',
        'SUMMARY:ประชุมวิชาการปีแผนกอายุรกรรม ประจำ 2568 (BRH)',
        'LOCATION:ห้องประชุม 901 ชั้น 9 อาคารเฉลิมพระเกียรติฯ โรงพยาบาลบุรีรัมย์, จังหวัดบุรีรัมย์',
        'DESCRIPTION:Harmony of Care: Bridging General Care to Specialty Medicine',
        'END:VEVENT',
        'END:VCALENDAR'
      ].join('\r\n');

      const blob = new Blob([ics], { type: 'text/calendar;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'BRH-IM-Conference-2568.ics';
      document.body.appendChild(a); a.click(); a.remove();
      setTimeout(() => URL.revokeObjectURL(url), 1000);
    });
  </script>
</body>
</html>
